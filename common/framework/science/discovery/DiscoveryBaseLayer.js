!function(){var e=ScienceBaseLayer.extend({_encourageLayer:null,_ENCOURAGE_LAYER_ZORDER:4e3,ctor:function(){this._super(),this._encourageLayer=new cc.Layer,this.addChild(this._encourageLayer,this._ENCOURAGE_LAYER_ZORDER)},onEnter:function(){this._super(),this.initUI({nav:{refresh:!1}})},onCloseCallback:function(){this._super(),this.videoPlayer&&this.videoPlayer.onClosed()},onEncourageCallback:function(){this.randomPlayEncourageAnimation()},randomPlayEncourageAnimation:function(){this.encourage||(this.encourage=new EncourageAnimation,this._encourageLayer.addChild(this.encourage)),this.encourage.randomPlay()},initConfig:function(e){this.initTitle(e.title),this.hideNavButton(),this.initPlayer(e.video)},initPlayer:function(e){var t=this.parseVideoConfig(e);this.videoPlayer=new i(t),this.addChild(this.videoPlayer),this.prevBtn=new Button([n.button_prev_png,n.button_prev2_png],this.prevPage,this),this.nextBtn=new Button([n.button_next_png,n.button_next2_png],this.nextPage,this),this.addChild(this.prevBtn,100),this.addChild(this.nextBtn,100),this.prevBtn.setPosition(cc.winSize.width-100,100),this.nextBtn.setPosition(cc.winSize.width-100,100),this.prevBtn.visible=!1,this.nextBtn.visible=!0},initPopupLayer:function(){},resumePlay:function(){this.videoPlayer.setVideoPlay()},parseVideoConfig:function(e){for(var t={keyPoints:[],mediaUrl:e.mediaUrl},i=this,n=0;n<e.keyPoints.length;n++)!function(n){var s=e.keyPoints[n];t.keyPoints.push({value:e.keyPoints[n].value,func:function(){s.layer&&s.layer.popup(i)},pause:void 0==s.pause?!0:s.pause,visible:void 0==s.visible?!0:s.visible,showPauseImg:void 0==s.showPauseImg?!1:s.showPauseImg})}(n);return t},gotoAndPlay:function(e){var t=this.videoPlayer._video;t.currentTime=e,this.videoPlayer.setVideoPlay()},prevPage:function(){this.prevBtn.visible=!1,this.nextBtn.visible=!0;var e=this.getChildByTag("popup");e&&e.close()},nextPage:function(){this.prevBtn.visible=!0,this.nextBtn.visible=!1;var e=this.getChildByTag("popup");e&&e.close()},hideNavButton:function(){var e=this.getNavButtonByTag("encourage");e&&e.setVisible(!1)},showNavButton:function(){var e=this.getNavButtonByTag("encourage");e&&e.setVisible(!0)},hidePageButton:function(){this.prevBtn.visible=!1,this.nextBtn.visible=!1}}),t=cc.Layer.extend({targetLayer:null,ctor:function(){this._super(),this.refreshBtn||(this.refreshBtn=new Button([navRes.button_refresh_normal_png,navRes.button_refresh_pressed_png],this.refresh,this),this.addChild(this.refreshBtn,200),this.refreshBtn.setPosition(cc.winSize.width-136,cc.winSize.height-35))},initContent:function(){},popup:function(e){this.targetLayer=e,this.targetLayer.addChild(this),this.targetLayer.showNavButton(),this.tag="popup",this.initContent()},close:function(){this.removeFromParent(!0),this.targetLayer.resumePlay(),this.targetLayer.hideNavButton()},refresh:function(){},setRefreshButtonVisible:function(e){this.refreshBtn.setVisible(e)},skipTo:function(e){this.targetLayer.gotoAndPlay(e),this.targetLayer.hideNavButton()}}),i=cc.progressBar1.extend({enableToggleBar:!1,ctor:function(e){this._super(e)}}),n={button_prev_png:"../../../common/res/science/wiki/button_prev.png",button_prev2_png:"../../../common/res/science/wiki/button_prev2.png",button_next_png:"../../../common/res/science/wiki/button_next.png",button_next2_png:"../../../common/res/science/wiki/button_next2.png"};addModuleResourceByName(pbRes),addModuleResourceByName(frame_success1),addModuleResourceByName(frame_success2),addModuleResourceByName(frame_success3),addModuleResourceByName(frame_success4),addModuleResourceByName(frame_success5),addModuleResourceByName(frame_success6),addModuleResourceByName(success_audio),window.DiscoveryPopupLayer=t,window.DiscoveryBaseLayer=e}();